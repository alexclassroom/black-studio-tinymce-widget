/* Black Studio TinyMCE Widget - v2.0.0 */
!function(a){function b(c){var d=null;return"string"==typeof c?d=c:"object"==typeof c&&c instanceof jQuery&&(d=a("textarea[id^=widget-black-studio-tinymce]",c.closest(bstw_data.container_selectors)).attr("id")),{activate:function(){if(a("#"+d).addClass("mceEditor"),"object"==typeof tinymce&&"function"==typeof tinymce.execCommand){this.deactivate(),tinyMCEPreInit.mceInit[d]=tinyMCEPreInit.mceInit["black-studio-tinymce-widget"],tinyMCEPreInit.mceInit[d].selector="#"+d;try{tinymce.init(tinymce.extend({},tinyMCEPreInit.mceInit["black-studio-tinymce-widget"],tinyMCEPreInit.mceInit[d])),tinymce.execCommand("mceAddControl",!1,d)}catch(b){window.alert(b)}null!==tinymce.get(d)&&"function"==typeof tinymce.get(d).on&&tinymce.get(d).on("keyup change",function(){var b=tinymce.get(d).getContent();a("#"+d).val(b).change()})}return this},deactivate:function(){if("object"==typeof tinymce&&"function"==typeof tinymce.execCommand&&null!==tinymce.get(d)&&"function"==typeof tinymce.get(d).getContent){var b=tinymce.get(d).getContent();tinymce.get(d).remove(),a("#"+d).val(b)}return this},activate_after_open:function(){return a("div.widget-inside:has(#"+d+") input[id^=widget-black-studio-tinymce][id$=type][value=visual]").each(function(){0===a("div.widget:has(#"+d+") :animated").size()&&null===tinymce.get(d)&&a("#"+d).is(":visible")?a("a[id^=widget-black-studio-tinymce][id$=tmce]",a(this).closest("div.widget-inside")).click():null===tinymce.get(d)?setTimeout(function(){b(d).activate_after_open(),d=null},100):a("a[id^=widget-black-studio-tinymce][id$=tmce]",a(this).closest("div.widget-inside")).click()}),this},activate_after_ajax:function(){return a("div.widget-inside:has(#"+d+") input[id^=widget-black-studio-tinymce][id$=type][value=visual]").each(function(){0===a.active&&null===tinymce.get(d)&&a("#"+d).is(":visible")?a("a[id^=widget-black-studio-tinymce][id$=tmce]",a(this).closest("div.widget-inside")).click():a("div.widget:has(#"+d+") div.widget-inside").is(":visible")&&null===tinymce.get(d)&&setTimeout(function(){b(d).activate_after_ajax(),d=null},100)}),this},get_widget:function(){return a("#"+d).closest("div.widget")},get_widget_inside:function(){return a("#"+d).closest("div.widget-inside")},get_editor_wrap:function(){return a("#"+d).closest("div.wp-editor-wrap")},get_textarea:function(){return a("#"+d)},get_id:function(){return d},get_tinymce:function(){return tinymce.get(d)},is_tinymce_active:function(){return null!==tinymce.get(d)},switch_to:function(b){var c="visual"===b?"tmce-active":"html-active",d="visual"===b?"html-active":"tmce-active";return this.get_editor_wrap().removeClass(d).addClass(c),a("input[id^=widget-black-studio-tinymce][id$=type]",this.get_widget_inside()).val(b),this},check_duplicates:function(){return a('[name="'+this.get_textarea().attr("name")+'"]').size()>1&&0===a("div.error",this.get_widget_inside()).length&&this.get_widget_inside().prepend('<div class="error"><strong>'+bstw_data.error_duplicate_id+"</strong></div>"),this},fix_css:function(){return this.get_widget().css("position","relative").css("z-index","100000"),a("#wpbody-content").css("overflow","visible"),this},set_media_target:function(){return a(".insert-media",this.get_widget()).data("editor",d),this}}}a(document).ready(function(){a(document).on("click","div.widget[id*=black-studio-tinymce] .widget-title, div.widget[id*=black-studio-tinymce] a.widget-action",function(){b(a(this)).check_duplicates().fix_css().set_media_target().activate_after_open()}),a(document).on("click","div.widget[id*=black-studio-tinymce] input[name=savewidget]",function(){b(a(this)).is_tinymce_active()&&b(a(this)).deactivate(),a(this).unbind("ajaxSuccess").ajaxSuccess(function(){b(a(this)).activate_after_ajax()})}),a(document).on("click","a[id^=widget-black-studio-tinymce][id$=tmce]",function(){b(a(this)).switch_to("visual").activate()}),a(document).on("click","a[id^=widget-black-studio-tinymce][id$=html]",function(){b(a(this)).switch_to("html").deactivate()}),a(document).on("widget-added",function(a,c){c.is("[id*=black-studio-tinymce]")&&(a.preventDefault(),b(c).activate_after_open())}),a(document).on("click",".wp-media-buttons a",function(){wpActiveEditor=b(a(this)).get_id()}),a("body.widgets_access").size()>0&&b(a("textarea[id^=widget-black-studio-tinymce]").attr("id")).activate_after_open()})}(jQuery);